<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>StellarSystemVisual.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">CircularOrbitHelper (1) (May 19, 2019 10:19:54 PM)</a> &gt; <a href="../../index.html" class="el_group">Lab4-1170300316</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">APIs</a> &gt; <span class="el_source">StellarSystemVisual.java</span></div><h1>StellarSystemVisual.java</h1><pre class="source lang-java linenums">package APIs;

import static org.junit.Assert.assertTrue;

import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.*;
import java.util.ArrayList;
import java.util.Set;
import java.util.regex.*;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;

import Log.LogFile;
import centralObject.CentralObject;
import centralObject.Stellar;
import circularOrbit.CircularOrbit;
import circularOrbit.ConcreteCircularOrbit;
import circularOrbit.StellarSystem;
import exception.IllegalNumberException;
import exception.SameLabelException;
import extensions.Position;
import physicalObject.Planet;
import track.Track;

import javax.swing.JLabel;
import javax.swing.ImageIcon;
import javax.swing.JComboBox;
import javax.swing.JButton;
import javax.swing.JTextPane;

public class StellarSystemVisual extends JFrame {

	public JPanel contentPane;
<span class="fc" id="L38">	public static CircularOrbit&lt;CentralObject, Track&gt; orbit = CircularOrbit.emptyStellarSystem();</span>

	// wait for implement
	// JLabel planet = new JLabel(&quot;New label&quot;);

	// -------//
	MovingOBJ mov;
	// -------//

<span class="fc" id="L47">	boolean run = true;</span>

	/**
	 * Launch the application.
	 * @throws IOException 
	 */
	public static void main(String[] args) throws IOException {
		// -----//
<span class="fc" id="L55">		MovingOBJ mov = new MovingOBJ();</span>
		// -----//

<span class="fc" id="L58">		Parse();</span>

<span class="fc" id="L60">		EventQueue.invokeLater(new Runnable() {</span>
			public void run() {
				try {
<span class="fc" id="L63">					StellarSystemVisual frame = new StellarSystemVisual(mov);</span>
					// ----------//
<span class="fc" id="L65">					mov.setPanel(frame);</span>
					// ----------//
<span class="fc" id="L67">					frame.setVisible(true);</span>

<span class="pc" id="L69">				} catch (Exception e) {</span>
<span class="nc" id="L70">					e.printStackTrace();</span>
				}
<span class="fc" id="L72">			}</span>
		});

		// Parse() was here
<span class="fc" id="L76">	}</span>

	/**
	 * Create the frame.
	 */
<span class="fc" id="L81">	public StellarSystemVisual(MovingOBJ mov) {</span>

<span class="fc" id="L83">		setTitle(&quot;Stellar System&quot;);</span>
<span class="fc" id="L84">		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span>
<span class="fc" id="L85">		setBounds(100, 100, 960, 640);</span>
<span class="fc" id="L86">		contentPane = new JPanel();</span>
<span class="fc" id="L87">		contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));</span>
<span class="fc" id="L88">		setContentPane(contentPane);</span>
<span class="fc" id="L89">		contentPane.setLayout(null);</span>

<span class="fc" id="L91">		orbit.Init(contentPane);</span>

		// The Label of the Sun
<span class="fc" id="L94">		JLabel sun = new JLabel(&quot;New label&quot;);</span>
<span class="fc" id="L95">		sun.setIcon(new ImageIcon(&quot;lib/StellarSystem/sun.png&quot;));</span>
<span class="fc" id="L96">		sun.setBounds(430, 270, 100, 100);</span>
<span class="fc" id="L97">		contentPane.add(sun);</span>

<span class="fc" id="L99">		JComboBox comboBox = new JComboBox();</span>
<span class="fc bfc" id="L100" title="All 2 branches covered.">		for (Track track : orbit.GetTrack()) {</span>
<span class="fc" id="L101">			comboBox.addItem(track.GetName());</span>
		}
<span class="fc" id="L103">		comboBox.setBounds(39, 22, 120, 27);</span>
<span class="fc" id="L104">		contentPane.add(comboBox);</span>

<span class="fc" id="L106">		JComboBox comboBox_1 = new JComboBox();</span>
<span class="fc bfc" id="L107" title="All 2 branches covered.">		for (Track track : orbit.GetTrack()) {</span>
<span class="fc" id="L108">			comboBox_1.addItem(track.GetName());</span>
		}
<span class="fc" id="L110">		comboBox_1.setBounds(39, 61, 120, 27);</span>
<span class="fc" id="L111">		contentPane.add(comboBox_1);</span>

<span class="fc" id="L113">		JButton btnNewButton = new JButton(&quot;Calculate&quot;);</span>
<span class="fc" id="L114">		btnNewButton.setBounds(39, 100, 120, 29);</span>
<span class="fc" id="L115">		contentPane.add(btnNewButton);</span>

<span class="fc" id="L117">		Position position = new Position(0, 0);</span>
<span class="fc" id="L118">		Position position_1 = new Position(0, 0);</span>

<span class="fc" id="L120">		JTextPane textPane = new JTextPane();</span>
<span class="fc" id="L121">		textPane.setBounds(39, 141, 120, 27);</span>
<span class="fc" id="L122">		contentPane.add(textPane);</span>

<span class="fc" id="L124">		btnNewButton.addActionListener(new ActionListener() {</span>
			public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L126" title="All 2 branches missed.">				for (Track track : orbit.GetTrack()) {</span>
<span class="nc bnc" id="L127" title="All 2 branches missed.">					if (track.GetName().equals(comboBox.getSelectedItem())) {</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">						for (Planet planet : track.getPhysicalObjects()) {</span>
<span class="nc" id="L129">							position.SetPosition(planet.GetPosition());</span>
						}
					}
<span class="nc bnc" id="L132" title="All 2 branches missed.">					if (track.GetName().equals(comboBox_1.getSelectedItem())) {</span>
<span class="nc bnc" id="L133" title="All 2 branches missed.">						for (Planet planet : track.getPhysicalObjects()) {</span>
<span class="nc" id="L134">							position_1.SetPosition(planet.GetPosition());</span>
						}
					}
				}
<span class="nc" id="L138">				System.out.println(&quot;Click &quot; + position.GetDegree());</span>
<span class="nc" id="L139">				System.out.println(&quot;Click2 &quot; + position_1.GetDegree());</span>
<span class="nc" id="L140">				textPane.setText(String.valueOf(Math.sqrt(</span>
<span class="nc" id="L141">						position.GetRadius() * position.GetRadius() + position_1.GetRadius() * position_1.GetRadius()</span>
<span class="nc" id="L142">								- 2 * position.GetRadius() * position_1.GetRadius()</span>
<span class="nc" id="L143">										* Math.cos((position.GetDegree() - position_1.GetDegree()) * Math.PI / 180))));</span>
<span class="nc" id="L144">			}</span>
		});

		// -----------//

<span class="fc" id="L149">		this.mov = mov;</span>
<span class="fc" id="L150">		mov.start();</span>
		// -----------//

<span class="fc" id="L153">	}</span>

	/**
	 * Assign the reading path
	 * @throws IOException 
	 */
	public static void Parse() throws IOException {
<span class="fc" id="L160">		String file1 = &quot;src/input/StellarSystem.txt&quot;;</span>
		
<span class="fc" id="L162">		LogFile.WriteError(&quot;Start reading data from &quot; + file1);</span>
		
		try {
<span class="nc" id="L165">			readFileByLines(file1);</span>
			
<span class="pc" id="L167">		} catch (IllegalNumberException e) {</span>
			// TODO Auto-generated catch block
<span class="fc" id="L169">			System.out.println(&quot;Illegal number found in the file. Please check the input file.&quot;);</span>
<span class="fc" id="L170">			e.printStackTrace();</span>
			
<span class="fc" id="L172">			LogFile.WriteError(e);</span>
			
<span class="fc" id="L174">			System.out.println(e.getMessage());</span>
<span class="nc" id="L175">		} catch (SameLabelException e) {</span>
			// TODO: handle exception
<span class="nc" id="L177">			System.out.println(&quot;Input file contains same planet. Please check the input file.&quot;);</span>
			
<span class="nc" id="L179">			LogFile.WriteError(e);</span>
			
<span class="nc" id="L181">			e.printStackTrace();</span>
		}

<span class="fc" id="L184">	}</span>

	/**
	 * Read the files from .txt Build the CircularOrbit
	 * 
	 * @param fileName
	 */
	private static void readFileByLines(String fileName)  throws IllegalNumberException, SameLabelException {

<span class="fc" id="L193">		BufferedReader reader = null;</span>
<span class="fc" id="L194">		Planet[] planet = new Planet[100];</span>

		try {
<span class="fc" id="L197">			System.out.println(&quot;Start reading from files.&quot;);</span>
<span class="fc" id="L198">			reader = new BufferedReader(new InputStreamReader(new FileInputStream(fileName), &quot;UTF-8&quot;));</span>
<span class="fc" id="L199">			String tempString = null;</span>
<span class="fc" id="L200">			int line = 1;</span>

			try {
<span class="pc bpc" id="L203" title="1 of 2 branches missed.">				while ((tempString = reader.readLine()) != null) {</span>
<span class="fc" id="L204">					String temp2 = tempString.replace(&quot; &quot;, &quot;&quot;);</span>
<span class="pc bpc" id="L205" title="1 of 2 branches missed.">					if (tempString.length() != 0) {</span>
						// System.out.println(tempString);
<span class="fc" id="L207">						System.out.println(&quot;line &quot; + line + &quot;:&quot; + tempString);</span>
<span class="fc bfc" id="L208" title="All 2 branches covered.">						if (tempString.startsWith(&quot;Stellar&quot;)) {</span>
<span class="fc" id="L209">							Pattern regex = Pattern.compile(&quot;&lt;(.*?),(.*?),(.*?)&gt;&quot;);</span>
<span class="fc" id="L210">							Matcher m = regex.matcher(tempString);</span>
							
							//Every param of regular expression must exist
<span class="fc" id="L213">							assertTrue(m.find());</span>
<span class="pc bpc" id="L214" title="1 of 2 branches missed.">							if (m.find()) {</span>
								// Add to THE STELLAR
<span class="nc" id="L216">								Stellar stellar = new Stellar(m.group(1), Double.valueOf(m.group(2)),</span>
<span class="nc" id="L217">										Double.valueOf(m.group(3)));</span>
<span class="nc" id="L218">								orbit.AddObjectToCentre(stellar);</span>
							}
							// System.out.println(&quot;Found value: &quot; + m.group(0));
						}

<span class="fc bfc" id="L223" title="All 2 branches covered.">						if (tempString.startsWith(&quot;Planet&quot;)) {</span>
<span class="fc" id="L224">							Pattern regex = Pattern.compile(&quot;&lt;(.*?),(.*?),(.*?),(.*?),(.*?),(.*?),(.*?),(.*?)&gt;&quot;);</span>
<span class="fc" id="L225">							Matcher m = regex.matcher(tempString);</span>
							
							//Every param of regular expression must exist
							//assertTrue(m.find());
							
<span class="pc bpc" id="L230" title="1 of 2 branches missed.">							if (m.find()) {</span>
								
<span class="fc bfc" id="L232" title="All 2 branches covered.">								for (Track track : orbit.GetTrack()) {</span>
<span class="pc bpc" id="L233" title="1 of 2 branches missed.">									if (track.GetName().equals(m.group(1))) {</span>
<span class="nc" id="L234">										throw new SameLabelException(m.group(1));</span>
									}
								}
								
<span class="pc bpc" id="L238" title="1 of 4 branches missed.">								if (Double.valueOf(m.group(8)) &gt;= 360 || Double.valueOf(m.group(8)) &lt; 0) {</span>
<span class="fc" id="L239">									throw new IllegalNumberException(Double.valueOf(m.group(8)));</span>
								}
								
<span class="pc bpc" id="L242" title="3 of 6 branches missed.">								if (Double.valueOf(m.group(4)) &lt; 10000 &amp;&amp; (m.group(4).contains(&quot;e&quot;) || m.group(4).contains(&quot;E&quot;))) {</span>
<span class="nc" id="L243">									throw new IllegalNumberException(Double.valueOf(m.group(4)));</span>
								}
								
<span class="pc bpc" id="L246" title="5 of 6 branches missed.">								if (Double.valueOf(m.group(4)) &gt;= 10000 &amp;&amp; (!m.group(4).contains(&quot;e&quot;) || !m.group(4).contains(&quot;E&quot;))) {</span>
<span class="nc" id="L247">									throw new IllegalNumberException(Double.valueOf(m.group(4)));</span>
								}
								
<span class="pc bpc" id="L250" title="1 of 2 branches missed.">								if (Double.valueOf(m.group(6)) &lt; 0) {</span>
<span class="nc" id="L251">									throw new IllegalNumberException(Double.valueOf(m.group(6)));</span>
								}
								
<span class="pc bpc" id="L254" title="1 of 2 branches missed.">								if (Double.valueOf(m.group(4)) &gt; Double.valueOf(m.group(5))) {</span>
<span class="nc" id="L255">									throw new IllegalNumberException(Double.valueOf(m.group(4)));</span>
								}
								// Add to planet

<span class="fc" id="L259">								planet[line] = new Planet(m.group(1), m.group(2), m.group(3),</span>
<span class="fc" id="L260">										Double.valueOf(m.group(4)), Double.valueOf(m.group(5)),</span>
<span class="fc" id="L261">										Double.valueOf(m.group(6)), m.group(7), Double.valueOf(m.group(8)));</span>

<span class="fc" id="L263">								orbit.AddObjectToTrack(planet[line]);</span>
							}
						}
<span class="fc" id="L266">						line++;</span>
					}

				}
<span class="nc" id="L270">			} catch (IOException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L272">				e.printStackTrace();</span>
			}

<span class="nc" id="L275">		} catch (UnsupportedEncodingException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L277">			e.printStackTrace();</span>
<span class="nc" id="L278">		} catch (FileNotFoundException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L280">			e.printStackTrace();</span>
		}
<span class="nc" id="L282">	}</span>
}

/**
 * The main frame refresh function Implement the actions done in one frame
 * 
 * @author tony
 *
 */
<span class="fc" id="L291">class MovingOBJ extends Thread {</span>
//  int x = 0;
//  int y = 400;
	StellarSystemVisual p;
<span class="fc" id="L295">	int time = 10;</span>

	public void setPanel(StellarSystemVisual p) {
<span class="fc" id="L298">		this.p = p;</span>
<span class="fc" id="L299">	}</span>

	@Override
	public void run() {

<span class="nc" id="L304">		while (true) {</span>
<span class="fc" id="L305">			p.contentPane.removeAll();</span>

			/*
			 * JButton btnNewButton = new JButton(&quot;Stop&quot;); btnNewButton.setBounds(39, 100,
			 * 120, 29); p.contentPane.add(btnNewButton);
			 * 
			 * btnNewButton.addActionListener(new ActionListener() {
			 * 
			 * @SuppressWarnings(&quot;deprecation&quot;) public void actionPerformed(ActionEvent e) {
			 * p.run = false; } });
			 */

			// The Label of the Sun

<span class="fc" id="L319">			JComboBox comboBox = new JComboBox();</span>
<span class="fc bfc" id="L320" title="All 2 branches covered.">			for (Track track : p.orbit.GetTrack()) {</span>
<span class="fc" id="L321">				comboBox.addItem(track.GetName());</span>
			}
<span class="fc" id="L323">			comboBox.setBounds(39, 22, 120, 27);</span>
<span class="fc" id="L324">			p.contentPane.add(comboBox);</span>

<span class="fc" id="L326">			JComboBox comboBox_1 = new JComboBox();</span>
<span class="fc bfc" id="L327" title="All 2 branches covered.">			for (Track track : p.orbit.GetTrack()) {</span>
<span class="fc" id="L328">				comboBox_1.addItem(track.GetName());</span>
			}
<span class="fc" id="L330">			comboBox_1.setBounds(39, 61, 120, 27);</span>
<span class="fc" id="L331">			p.contentPane.add(comboBox_1);</span>

<span class="fc" id="L333">			JButton btnNewButton = new JButton(&quot;Calculate&quot;);</span>
<span class="fc" id="L334">			btnNewButton.setBounds(39, 100, 120, 29);</span>
<span class="fc" id="L335">			p.contentPane.add(btnNewButton);</span>

<span class="fc" id="L337">			Position position = new Position(0, 0);</span>
<span class="fc" id="L338">			Position position_1 = new Position(0, 0);</span>

<span class="fc" id="L340">			JTextPane textPane = new JTextPane();</span>
<span class="fc" id="L341">			textPane.setBounds(39, 141, 120, 27);</span>
<span class="fc" id="L342">			p.contentPane.add(textPane);</span>

<span class="fc" id="L344">			textPane.setText(&quot;Click calculator to Pause&quot;);</span>

<span class="fc" id="L346">			btnNewButton.addActionListener(new ActionListener() {</span>
				public void actionPerformed(ActionEvent e) {
<span class="fc" id="L348">					time = 100000;</span>
<span class="fc bfc" id="L349" title="All 2 branches covered.">					for (Track track : p.orbit.GetTrack()) {</span>
<span class="fc bfc" id="L350" title="All 2 branches covered.">						if (track.GetName().equals(comboBox.getSelectedItem())) {</span>
<span class="fc bfc" id="L351" title="All 2 branches covered.">							for (Planet planet : track.getPhysicalObjects()) {</span>
<span class="fc" id="L352">								position.SetPosition(planet.GetPosition());</span>
							}
						}
<span class="fc bfc" id="L355" title="All 2 branches covered.">						if (track.GetName().equals(comboBox_1.getSelectedItem())) {</span>
<span class="fc bfc" id="L356" title="All 2 branches covered.">							for (Planet planet : track.getPhysicalObjects()) {</span>
<span class="fc" id="L357">								position_1.SetPosition(planet.GetPosition());</span>
							}
						}
					}
<span class="fc" id="L361">					System.out.println(&quot;Click &quot; + position.GetDegree());</span>
<span class="fc" id="L362">					System.out.println(&quot;Click2 &quot; + position_1.GetDegree());</span>
<span class="fc" id="L363">					textPane.setText(String.valueOf(Math.sqrt(position.GetRadius() * position.GetRadius()</span>
<span class="fc" id="L364">							+ position_1.GetRadius() * position_1.GetRadius()</span>
<span class="fc" id="L365">							- 2 * position.GetRadius() * position_1.GetRadius()</span>
<span class="fc" id="L366">									* Math.cos((position.GetDegree() - position_1.GetDegree()) * Math.PI / 180))));</span>
<span class="fc" id="L367">				}</span>
			});

<span class="fc" id="L370">			JLabel sun = new JLabel(&quot;New label&quot;);</span>
<span class="fc" id="L371">			sun.setIcon(new ImageIcon(&quot;lib/StellarSystem/sun.png&quot;));</span>
<span class="fc" id="L372">			sun.setBounds(430, 270, 100, 100);</span>
<span class="fc" id="L373">			p.contentPane.add(sun);</span>

<span class="fc" id="L375">			System.out.println(&quot;Running&quot;);</span>
			// The Label of the background
<span class="fc" id="L377">			p.orbit.Update(p.contentPane);</span>
<span class="fc" id="L378">			p.orbit.Init(p.contentPane);</span>

			// The Label of the background
<span class="fc" id="L381">			JLabel bg = new JLabel(&quot;New label&quot;);</span>
<span class="fc" id="L382">			bg.setIcon(new ImageIcon(&quot;lib/StellarSystem/universe.png&quot;));</span>
<span class="fc" id="L383">			bg.setBounds(0, 0, 960, 640);</span>
<span class="fc" id="L384">			p.contentPane.add(bg);</span>

<span class="fc" id="L386">			p.contentPane.updateUI();</span>
			try {
<span class="fc" id="L388">				sleep(time * 10);</span>
<span class="pc" id="L389">			} catch (InterruptedException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L391">				e.printStackTrace();</span>
			}
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.3.201901230119</span>CircularOrbitHelper (1) (May 19, 2019 10:19:54 PM)</div></body></html>